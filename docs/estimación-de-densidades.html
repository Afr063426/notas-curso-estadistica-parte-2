<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 2 Estimación de densidades | Notas Curso de Estadística</title>
  <meta name="description" content="Capítulo 2 Estimación de densidades | Notas Curso de Estadística" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 2 Estimación de densidades | Notas Curso de Estadística" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 2 Estimación de densidades | Notas Curso de Estadística" />
  
  
  

<meta name="author" content="Maikol Solís" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="jacknife-y-bootstrap.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso de Estadística</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html"><i class="fa fa-check"></i><b>2</b> Estimación de densidades</a><ul>
<li class="chapter" data-level="2.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#histograma"><i class="fa fa-check"></i><b>2.1</b> Histograma</a><ul>
<li class="chapter" data-level="2.1.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#construcción-estadística"><i class="fa fa-check"></i><b>2.1.1</b> Construcción Estadística</a></li>
<li class="chapter" data-level="2.1.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#construcción-probabilistica"><i class="fa fa-check"></i><b>2.1.2</b> Construcción probabilistica</a></li>
<li class="chapter" data-level="2.1.3" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#propiedades-estadísticas"><i class="fa fa-check"></i><b>2.1.3</b> Propiedades estadísticas</a></li>
<li class="chapter" data-level="2.1.4" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#sesgo"><i class="fa fa-check"></i><b>2.1.4</b> Sesgo</a></li>
<li class="chapter" data-level="2.1.5" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#varianza"><i class="fa fa-check"></i><b>2.1.5</b> Varianza</a></li>
<li class="chapter" data-level="2.1.6" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#error-cuadrático-medio"><i class="fa fa-check"></i><b>2.1.6</b> Error cuadrático medio</a></li>
<li class="chapter" data-level="2.1.7" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.1.7</b> Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.1.8" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#ancho-de-banda-óptimo-para-el-histograma"><i class="fa fa-check"></i><b>2.1.8</b> Ancho de banda óptimo para el histograma</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#estimación-no-paramétrica-de-densidad"><i class="fa fa-check"></i><b>2.2</b> Estimación No-paramétrica de densidad</a><ul>
<li class="chapter" data-level="2.2.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#primera-construcción"><i class="fa fa-check"></i><b>2.2.1</b> Primera construcción</a></li>
<li class="chapter" data-level="2.2.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#otra-construcción"><i class="fa fa-check"></i><b>2.2.2</b> Otra construcción</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#propiedades-estadísticas-1"><i class="fa fa-check"></i><b>2.3</b> Propiedades Estadísticas</a><ul>
<li class="chapter" data-level="2.3.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#varianza-1"><i class="fa fa-check"></i><b>2.3.1</b> Varianza</a></li>
<li class="chapter" data-level="2.3.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#sesgo-1"><i class="fa fa-check"></i><b>2.3.2</b> Sesgo</a></li>
<li class="chapter" data-level="2.3.3" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#error-cuadrático-medio-y-error-cuadrático-medio-integrado"><i class="fa fa-check"></i><b>2.3.3</b> Error cuadrático medio y Error cuadrático medio integrado</a></li>
<li class="chapter" data-level="2.3.4" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#ancho-de-banda-óptimo"><i class="fa fa-check"></i><b>2.3.4</b> Ancho de banda óptimo</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#escogiendo-el-ancho-de-banda"><i class="fa fa-check"></i><b>2.4</b> Escogiendo el ancho de banda</a><ul>
<li class="chapter" data-level="2.4.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#referencia-normal"><i class="fa fa-check"></i><b>2.4.1</b> Referencia normal</a></li>
<li class="chapter" data-level="2.4.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#validación-cruzada"><i class="fa fa-check"></i><b>2.4.2</b> Validación Cruzada</a></li>
<li class="chapter" data-level="2.4.3" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos"><i class="fa fa-check"></i><b>2.4.3</b> Intervalos de confianza para estimadores de densidad no paramétricos</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#laboratorio"><i class="fa fa-check"></i><b>2.5</b> Laboratorio</a><ul>
<li class="chapter" data-level="2.5.1" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#efecto-de-distintos-kernels-en-la-estimación"><i class="fa fa-check"></i><b>2.5.1</b> Efecto de distintos Kernels en la estimación</a></li>
<li class="chapter" data-level="2.5.2" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#efecto-del-ancho-de-banda-en-la-estimación"><i class="fa fa-check"></i><b>2.5.2</b> Efecto del ancho de banda en la estimación</a></li>
<li class="chapter" data-level="2.5.3" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#ancho-de-banda-óptimo-1"><i class="fa fa-check"></i><b>2.5.3</b> Ancho de banda óptimo</a></li>
<li class="chapter" data-level="2.5.4" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#validación-cruzada-1"><i class="fa fa-check"></i><b>2.5.4</b> Validación cruzada</a></li>
<li class="chapter" data-level="2.5.5" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#temas-adicionales"><i class="fa fa-check"></i><b>2.5.5</b> Temas adicionales</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="estimación-de-densidades.html"><a href="estimación-de-densidades.html#ejercicios"><i class="fa fa-check"></i><b>2.6</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html"><i class="fa fa-check"></i><b>3</b> Jacknife y Bootstrap</a><ul>
<li class="chapter" data-level="3.1" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#caso-concreto"><i class="fa fa-check"></i><b>3.1</b> Caso concreto</a></li>
<li class="chapter" data-level="3.2" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#jacknife"><i class="fa fa-check"></i><b>3.2</b> Jacknife</a></li>
<li class="chapter" data-level="3.3" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#bootstrap"><i class="fa fa-check"></i><b>3.3</b> Bootstrap</a><ul>
<li class="chapter" data-level="3.3.1" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>3.3.1</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="3.3.2" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#intervalo-pivotal-studentizado"><i class="fa fa-check"></i><b>3.3.2</b> Intervalo pivotal studentizado</a></li>
<li class="chapter" data-level="3.3.3" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#resumiendo"><i class="fa fa-check"></i><b>3.3.3</b> Resumiendo</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="jacknife-y-bootstrap.html"><a href="jacknife-y-bootstrap.html#ejercicios-1"><i class="fa fa-check"></i><b>3.4</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html"><i class="fa fa-check"></i><b>4</b> Estimación de densidades con Bayes</a><ul>
<li class="chapter" data-level="4.1" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#introducción-a-la-estimación-bayesiana"><i class="fa fa-check"></i><b>4.1</b> Introducción a la estimación Bayesiana</a><ul>
<li class="chapter" data-level="4.1.1" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#preliminares"><i class="fa fa-check"></i><b>4.1.1</b> Preliminares</a></li>
<li class="chapter" data-level="4.1.2" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#ejemplo-sencillo"><i class="fa fa-check"></i><b>4.1.2</b> Ejemplo sencillo</a></li>
<li class="chapter" data-level="4.1.3" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#datos-reales"><i class="fa fa-check"></i><b>4.1.3</b> Datos reales</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#previa-de-histograma"><i class="fa fa-check"></i><b>4.2</b> Previa de histograma</a></li>
<li class="chapter" data-level="4.3" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#métodos-monte-carlo"><i class="fa fa-check"></i><b>4.3</b> Métodos Monte Carlo</a></li>
<li class="chapter" data-level="4.4" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#una-moneda"><i class="fa fa-check"></i><b>4.4</b> Una moneda</a><ul>
<li class="chapter" data-level="4.4.1" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#ejemplo-del-viajero"><i class="fa fa-check"></i><b>4.4.1</b> Ejemplo del viajero</a></li>
<li class="chapter" data-level="4.4.2" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#cadenas-de-markov"><i class="fa fa-check"></i><b>4.4.2</b> Cadenas de Markov</a></li>
<li class="chapter" data-level="4.4.3" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#el-algoritmo-de-metropolis-hasting"><i class="fa fa-check"></i><b>4.4.3</b> El algoritmo de Metropolis-Hasting</a></li>
<li class="chapter" data-level="4.4.4" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#por-qué-el-algoritmo-de-metropolis-hasting-funciona"><i class="fa fa-check"></i><b>4.4.4</b> ¿Por qué el algoritmo de Metropolis Hasting funciona?</a></li>
<li class="chapter" data-level="4.4.5" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#extensión-al-caso-del-viajero"><i class="fa fa-check"></i><b>4.4.5</b> Extensión al caso del viajero</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#dos-monedas"><i class="fa fa-check"></i><b>4.5</b> Dos monedas</a><ul>
<li class="chapter" data-level="4.5.1" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#muestreo-de-gibbs"><i class="fa fa-check"></i><b>4.5.1</b> Muestreo de Gibbs</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#uso-de-jags"><i class="fa fa-check"></i><b>4.6</b> Uso de JAGS</a></li>
<li class="chapter" data-level="4.7" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#uso-de-stan"><i class="fa fa-check"></i><b>4.7</b> Uso de STAN</a></li>
<li class="chapter" data-level="4.8" data-path="estimación-de-densidades-con-bayes.html"><a href="estimación-de-densidades-con-bayes.html#ejercicios-2"><i class="fa fa-check"></i><b>4.8</b> Ejercicios</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas Curso de Estadística</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimación-de-densidades" class="section level1">
<h1><span class="header-section-number">Capítulo 2</span> Estimación de densidades</h1>
<div id="histograma" class="section level2">
<h2><span class="header-section-number">2.1</span> Histograma</h2>
<p>El histograma es una de las estructuras básicas en estadística. Básicamente con este objeto se puede visualizar la distribución de los datos sin tener conocimiento previo de los mismos.</p>
<div id="construcción-estadística" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Construcción Estadística</h3>
<p>Suponga que <span class="math inline">\(X_1,X_2, \dots ,X_n\)</span> proviene de una distribución desconocida.</p>
<ul>
<li><p>Seleccione un origen <span class="math inline">\(x_0\)</span> y divida la linea real en <em>segmentos</em>.
<span class="math display">\[\begin{equation*}
B_j = [x_0 +(j - 1)h,x_0 + jh) \quad j\in \mathbb{Z}
\end{equation*}\]</span></p></li>
<li><p>Cuente cuántas observaciones caen en cada segmento. <span class="math inline">\(n_j\)</span>.</p></li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/observaciones-histograma-1.svg" width="672" />
- Cuente la frecuencia por el tamaño de muestra <span class="math inline">\(n\)</span> y el ancho de banda <span class="math inline">\(h\)</span>.
<span class="math display">\[\begin{equation*}
f_j = \frac{n_j}{nh}
\end{equation*}\]</span></p>
<ul>
<li>Dibuje el histograma.</li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/ejemplo-inicial-histograma-1.svg" width="672" /></p>
<p>Formalmente el histograma es el</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(x) = \frac{1}{nh} \sum_{i = 1}^{n} \sum_{j} I(X_i\in B_j) I(x\in B_j),
\end{equation*}\]</span></p>
<p>donde <span class="math inline">\(I\)</span> es la indicadora.</p>
</div>
<div id="construcción-probabilistica" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Construcción probabilistica</h3>
<p>Denote <span class="math inline">\(m_j=jh-h/2\)</span> el centro del segmento,</p>
<p><span class="math display">\[\begin{align*}
\mathbb{P}\left(X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2} \right)\right) &amp; =
\int_{m_j - \frac{h}{2}}^{m_j + \frac{h}{2}} f(u)du                                             \\
&amp; \approx f(m_j)h
\end{align*}\]</span></p>
<p>Esto se puede aproximar como</p>
<p><span class="math display">\[\begin{equation*}
\mathbb{P} \left(X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right)  \approx   \frac{1}{n} \#
\left\{X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right\}
\end{equation*}\]</span></p>
<p>Acomodando un poco la expresión</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(m_j) =  \frac{1}{nh} \#
\left\{X\in \left[m_j - \frac{h}{2},m_j + \frac{h}{2}\right) \right\}
\end{equation*}\]</span></p>
</div>
<div id="propiedades-estadísticas" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Propiedades estadísticas</h3>
<p>Suponga que <span class="math inline">\(x_0 = 0\)</span> y que <span class="math inline">\(x \in B_j\)</span> fijo, entonces</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_h(m_j) =  \frac{1}{nh} \sum_{i = 1}^{n} I(X_i \in B_j)
\end{equation*}\]</span></p>
</div>
<div id="sesgo" class="section level3">
<h3><span class="header-section-number">2.1.4</span> Sesgo</h3>
<p>El cálculo del sesgo es el</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[ \hat{f}_h(m_j)\right]
&amp; =  \frac{1}{nh} \sum_{i = 1}^{n} \mathbb{E}\left[ I(X_i \in B_j)\right] \\
&amp; = \frac{1}{nh} n \mathbb{E}\left[ I(X_i \in B_j)\right]
\end{align*}\]</span></p>
<p><span class="math inline">\(I(X_i \in B_j)\)</span> es una indicadora con probabilidad de 1 de <span class="math inline">\(\int_{(j - 1)h}^{jh} f(u)du\)</span> y 0 sino.</p>
<p>Entonces</p>
<p><span class="math display">\[\begin{align*}
\mathbb{E}\left[ I(X_i \in B_j)\right] = \mathbb{P}\left(I(X_i \in
B_j)=1\right) = \int_{(j - 1)h}^{jh} f(u)du.
\end{align*}\]</span></p>
<p>Entonces,
<span class="math display">\[\begin{align*}
\mathbb{E}\left[{f}_h(m_j)\right]
&amp; = \frac{1}{h} \int_{(j - 1)h}^{jh} f(u)du
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
Sesgo(\hat{f}_h(m_j)) = \frac{1}{h} \int_{(j -
1)h}^{jh} f(u)du - f(x)
\end{equation*}\]</span></p>
<p>Esto se puede aproximar usando Taylor alrededor del centro <span class="math inline">\(m_j = jh - h/2\)</span> de <span class="math inline">\(B_j\)</span> de modo que <span class="math inline">\(f(u) - f(x) \approx f^{\prime}(m_j)(u - x)\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
Sesgo(\hat{f}_h(m_j)) =  \frac{1}{h} \int_{(j -
1)h}^{jh} f(u) - f(x) du \approx f^\prime(m_j)(m_j - x)
\end{equation*}\]</span></p>
</div>
<div id="varianza" class="section level3">
<h3><span class="header-section-number">2.1.5</span> Varianza</h3>
<p>Dado que todos los <span class="math inline">\(X_i\)</span> son i.i.d., entonces</p>
<p><span class="math display">\[\begin{align*}
\mathrm{Var}\left( \hat{f}_h(m_j)\right) &amp; =
\mathrm{Var}\left( \frac{1}{nh} \sum_{i = 1}^{n} I(X_i \in B_j)\right)                                  \\
&amp; = \frac{1}{n^2h^2} n\mathrm{Var}\left( I(X_i \in B_j)\right)
\end{align*}\]</span></p>
<p>La variable <span class="math inline">\(I\)</span> es una bernoulli con parametro <span class="math inline">\(\int_{(j - 1)h}^{h} f(u)du\)</span> por lo tanto su varianza es el</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Var}\left( \hat{f}_h(x)\right)\, =
\frac{1}{nh^2} \left(\int_{(j - 1)h}^{h} f(u)du \right)\left( 1 -\int_{(j - 1)h}^{h} f(u)du \right)
\end{equation*}\]</span></p>

<div class="exercise">
<span id="exr:unnamed-chunk-3" class="exercise"><strong>Ejercicio 2.1  </strong></span>Usando un desarrollo de Taylor como en la parte anterior, pruebe que:
<span class="math display">\[\begin{equation*}
\mathrm{Var}\left( \hat{f}_h(x)\right)\approx
\frac{1}{nh} f(x)
\end{equation*}\]</span>
</div>

</div>
<div id="error-cuadrático-medio" class="section level3">
<h3><span class="header-section-number">2.1.6</span> Error cuadrático medio</h3>
<p>El error cuadrático medio del histograma es el</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MSE}\left( \hat{f}_h(x)\right) =
\mathrm{E}\left[\left(\hat{f}_h(x) - f(x)\right)^2\right] = \mathrm{Sesgo}^2\left( \hat{f}_h(x)\right) + \mathrm{Var}\left( \hat{f}_h(x)\right).
\end{equation*}\]</span></p>

<div class="exercise">
<span id="exr:unnamed-chunk-4" class="exercise"><strong>Ejercicio 2.2  </strong></span>¿Pueden probar la segunda igualdad de la expresión anterior?
</div>


<div class="solution">
 <span class="solution"><em>Solución. </em></span> Prueba segunda igualdad:
<span class="math display">\[\begin{align*}
&amp; \text{Sesgo}^2\left(\hat{f}_h(x)  \right) + \text{Var}\left( \hat{f}_h(x)\right)  = \\ &amp; \left[ E\left(\hat{f}_h(x)\right) - f(x)\right]^2 + E\left[\left( E\left(\hat{f}_h(x)\right) - \hat{f}_h(x)\right)^2\right] \ =
\\ &amp; E\left[\left[ E\left(\hat{f}_h(x)\right) - f(x)\right]^2 + \left( E\left(\hat{f}_h(x)\right) - \hat{f}_h(x)\right)^2   \right] \ \textcolor{red}{(*)} \
\end{align*}\]</span>
Ahora note que:
<span class="math display">\[\begin{align*}
&amp; E\left[\left( E\left(\hat{f}_h(x)\right) - f(x)   \right) \left(E\left(\hat{f}_h(x)\right) - \hat{f}_h(x)    \right)    \right] \ = \                                      \\
&amp; E\left[E\left(\hat{f}_h(x)\right)^2 \right] \ - \ E\left[E\left(\hat{f}_h(x)\right)\cdot \hat{f}_h(x) \right] \ - \ E\left[f(x)\cdot E\left(\hat{f}_h(x)\right)\right] \ + \\
&amp; E\left[f(x)\cdot \hat{f}_h(x)\right]\ = \                                                                                                                                  \\
&amp; E\left(\hat{f}_h(x)\right)^2  \ - \ E\left(\hat{f}_h(x)\right)^2  \ - \ E\left(\hat{f}_h(x)\right)\cdot E\left( f(x)\right) \ + \
E\left( f(x)\right)\cdot E\left(\hat{f}_h(x)\right) \                                                                                                                         \\
&amp; = 0
\end{align*}\]</span>
Entonces:
<span class="math display">\[\begin{align*}
&amp; \textcolor{red}{(*)} \ = \ E\left[\left[ E\left(\hat{f}_h(x)\right) - f(x)\right]^2 \ -  \right.                                                                                                         \\
&amp; \left. \ 2\left( E\left(\hat{f}_h(x)\right) - f(x)   \right) \left(E\left(\hat{f}_h(x)\right) - \hat{f}_h(x)    \right) \ + \ \left( E\left(\hat{f}_h(x)\right) - \hat{f}_h(x)\right)^2   \right] \ = \  \\
&amp; E\left[ \left(E\left(\hat{f}_h(x)\right) - f(x) \ - \ E\left(\hat{f}_h(x)\right) + \hat{f}_h(x) \right)^2   \right] \ = \                                                                                \\
&amp; E\left[\left(\hat{f}_h(x) - f(x)\right)^2    \right]
\end{align*}\]</span>

</div>

<p>Retomando los términos anteriores se tiene que</p>
<p><span class="math display">\[\begin{multline*}
\mathrm{MSE}\left( \hat{f}_h(x)\right) =
\frac{1}{nh} f(x) + f^\prime
\left\{
\left(
j - \frac{1}{2}
\right) h
\right\}^2
\left\{
\left(
j - \frac{1}{2}
\right) h - x
\right\}^2 \\
+ o\left(h \right) +        o\left(\frac{1}{nh} \right)
\end{multline*}\]</span></p>

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> Si <span class="math inline">\(h \to 0\)</span> y <span class="math inline">\(nh \to \infty\)</span> entonces <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right) \to 0\)</span>. Es decir, conforme usamos más observaciones, pero el ancho de banda de banda no decrece tan rápida, entonces el error cuadrático medio converge a 0.</p>
Esto indica que si <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right) \to 0\)</span> (convergencia en <span class="math inline">\(\mathbb{L}^2\)</span>) implica que <span class="math inline">\(\hat{f}_h(x) \stackrel{\mathcal{P}}{\to} f(x)\)</span>, por lo tanto <span class="math inline">\(\hat{f}_h\)</span> es consistente.
</div>

<p>La fórmula anterior tiene la siguiente particularidad</p>
<ul>
<li>Si <span class="math inline">\(h\to 0\)</span>, la varianza crece (converge a <span class="math inline">\(\infty\)</span>) y el sesgo decrece (converge a <span class="math inline">\(f^\prime (0)x^2\)</span>).</li>
<li>Si <span class="math inline">\(h\to \infty\)</span>, la varianza decrece (hacia 0) y el sesgo crece (hacia <span class="math inline">\(\infty\)</span>)</li>
</ul>
<p>Note que la figura siguiente tiene esa propiedad.</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/MSE-histograma-1.svg" width="672" /></p>
</div>
<div id="error-cuadrático-medio-integrado" class="section level3">
<h3><span class="header-section-number">2.1.7</span> Error cuadrático medio integrado</h3>
<p>El problema con el <span class="math inline">\(\mathrm{MSE}\left( \hat{f}_h(x)\right)\)</span> es que depende completamente del punto escogido <span class="math inline">\(x\)</span>.</p>
<p>La solución a esto es integrar el MSE.</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MISE}\left(  \hat{f}_h(x)\right)
&amp; = \mathrm{E}\left[
\int_{ -\infty}^{\infty} \left\{
\hat{f}_h(x) - f(x)
\right\}^2 dx
\right]                                                       \\
&amp; = \int_{ -\infty}^{\infty} \mathrm{E}\left[
\left\{
\hat{f}_h(x) - f(x)
\right\}^2
\right] dx                                                    \\
&amp; = \int_{ -\infty}^{\infty}\mathrm{MSE}(\hat{f}_h(x)) \, dx
\end{align*}\]</span></p>
<p>Además,</p>
<p><span class="math display">\[\begin{align*}
\mathrm{MISE} (\hat{f}_h(x))
&amp; = \int_{ -\infty}^{\infty} \frac{1}{nh} f(x)dx                                                                                                                                          \\
&amp; + \int_{ -\infty}^{\infty}\, \sum_{j}^{} I(x\in B_j) \left\{ \left( j- \frac{1}{2} \right)h -x  \right\}^2 \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2 dx \\
&amp; = \frac{1}{nh} + \sum_{j}^{} \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2 \int_{ B_j}    \left\{ \left( j- \frac{1}{2} \right)h -x  \right\}^2 dx          \\
&amp; =\frac{1}{nh} + \frac{h^2}{12} \sum_{j} \left [f^\prime \left( \left\{j - \frac{1}{2}\right\}h \right)  \right]^2                                                                       \\
&amp; \approx \frac{1}{nh} + \frac{h^2}{12} \int \{f^\prime(x)\}^2 dx                                                                                                                         \\
&amp; =\frac{1}{nh} + \frac{h^2}{12} \Vert f^\prime\Vert_{2}^2
\end{align*}\]</span></p>
</div>
<div id="ancho-de-banda-óptimo-para-el-histograma" class="section level3">
<h3><span class="header-section-number">2.1.8</span> Ancho de banda óptimo para el histograma</h3>
<p>El MISE tiene el mismo comportamiento que el MSE. La figura siguiente presenta el comportamiento de la varianza, sesgo y MISE para nuestro ejemplo.</p>
<div class="figure">
<img src="Notas-Curso-Estadistica_files/figure-html/MISE-histograma-1.svg" alt=" " width="672" />
<p class="caption">
</p>
</div>
<p>La mala elección del parámetro <span class="math inline">\(h\)</span> causa que el histograma no capture toda la estructura de los datos.</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-8-1.svg" width="672" /></p>
<p>En este caso se puede simplemente minimizar el MISE de la forma usual,</p>
<p><span class="math display">\[\begin{equation*}
\frac{\partial \mathrm{MISE}(f_{h})}{\partial h} = -\frac{1}{nh^2} + \frac{1}{6} h \Vert f^\prime\Vert_{2}^2 = 0
\end{equation*}\]</span></p>
<p>implica que</p>
<p><span class="math display">\[\begin{equation*}
h_{opt} = \left(\frac{6}{n\Vert f^\prime\Vert_{2}^2}\right) ^{1/3} = O\left( n^{1/3} \right).
\end{equation*}\]</span></p>
<p>y que por lo tanto</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MISE}(\hat{f}_{h}) = \frac{1}{n} \left(\frac{n\Vert f^\prime\Vert_{2}^2}{6}\right)  ^{1/3}
\end{equation*}\]</span></p>

<div class="remark">
<p> <span class="remark"><em>Nota</em> (Recuerde de Estadística I): </span> Si <span class="math inline">\(X_1, \ldots, X_2 \sim f_{\theta}\)</span> i.i.d, con <span class="math inline">\(\mathrm{Var}(X) = \sigma^2\)</span>, recuerde que el estimador <span class="math inline">\(\hat{\theta}\)</span> de <span class="math inline">\(\theta\)</span> tiene la característica que</p>
<span class="math display">\[\begin{equation*}
\mathrm{MSE}(\theta) = \mathrm{Var}(\hat{\theta}) +
\mathrm{Sesgo}^2(\hat{\theta}) = \frac{\sigma^2}{n}
\end{equation*}\]</span>
</div>

<p>Según la nota anterior la tasas de convergencia del histograma es más lenta que la de un estimador parámetrico considerando la misma cantidad de datos.</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-10-1.svg" width="672" /></p>
<p>Finalmente, podemos encontrar el valor óptimo de esta datos dado por <span class="math inline">\(h=\)</span><code>h_opt_MISE</code>
<img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-12-1.svg" width="672" /></p>
</div>
</div>
<div id="estimación-no-paramétrica-de-densidad" class="section level2">
<h2><span class="header-section-number">2.2</span> Estimación No-paramétrica de densidad</h2>
<div id="primera-construcción" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Primera construcción</h3>
<p>Sea <span class="math inline">\(X_{1},\ldots,X_{n}\)</span> variables aleatorias i.i.d. con distribución <span class="math inline">\(f\)</span> en <span class="math inline">\(\mathbb{R}\)</span>.</p>
<p>La distribución de <span class="math inline">\(f\)</span> es <span class="math inline">\(F(x)=\int_{-\infty}^{x}f(t)dt\)</span>.</p>
<p>Considere la distribución empírica como
<span class="math display">\[
F_{n}(x)=\frac{1}{n}\sum_{i=1}^{n}I(X_{i}\leq x).
\]</span></p>
<p>Por la ley de los grandes números tenemos que <span class="math inline">\(\hat{F}_{n}(x) \xrightarrow{c.s} F(x)\)</span> para todo <span class="math inline">\(x\)</span> en <span class="math inline">\(\mathbb{R}\)</span>as
<span class="math inline">\(n\rightarrow\infty\)</span>. Entonces, <span class="math inline">\(F_{n}(x)\)</span> es consistente</p>
<p>para todo <span class="math inline">\(x\)</span> in <span class="math inline">\(\mathbb{R}\)</span>.</p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Podríamos derivar <span class="math inline">\(\hat{F}_n\)</span> para encontrar el estimar <span class="math inline">\(\hat{f}_n\)</span>?
</div>

<p>La respuesta es si (más o menos).</p>
<p>Suponga que <span class="math inline">\(h&gt;0\)</span> tenemos la aproximación
<span class="math display">\[
f(x)\approx\frac{F(x+h)-F(x-h)}{2h}.
\]</span></p>
<p>Remplazando <span class="math inline">\(F\)</span> por su estimador <span class="math inline">\(\hat{F}_{n}\)</span>, defina
<span class="math display">\[
\hat{f}_{n}^{R}(x)=\frac{F_{n}(x+h)-F_{n}(x-h)}{2h},
\]</span>
donde <span class="math inline">\(\hat{f}_{n}^{R}(x)\)</span> es el estimador de <em>Rosenblatt </em>.</p>
<p>Podemos rescribirlo de la forma,
<span class="math display">\[
\hat{f}_{n}^{R}(x)=\frac{1}{2nh}\sum_{i=1}^{n}I(x-h&lt;X_{i}\leq x+h)=\frac{1}{nh}\sum_{i=1}^{n}K_{0}\left(\frac{X_{i}-x}{h}\right)
\]</span>
con <span class="math inline">\(K_{0}(u)=\frac{1}{2}I(-1&lt;u\leq1)\)</span>, lo cuál es equivalente al caso del histograma.</p>
</div>
<div id="otra-construcción" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Otra construcción</h3>
<p>Con el histograma construimos una serie de segmentos fijo <span class="math inline">\(B_{j}\)</span> y contabamos el número de datos que estaban <strong>CONTENIDOS en <span class="math inline">\(B_{j}\)</span></strong></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Qué pasaría si cambiamos la palabra <strong>CONTENIDOS</strong> por <strong>ALREDEDOR DE “x”</strong>?
</div>

<p>Suponga que se tienen intervalos de longitud $ 2h $, es decir, intervalos de la forma $ [x-h,x+h) $.</p>
<p>El histograma se escribe como</p>
<p><span class="math display">\[\begin{equation*}
\hat{f_{h}}(x) = \dfrac{1}{2hn} \# \{ X_i \in [x-h,x+h) \}.
\end{equation*}\]</span></p>
<p>Ahora tratemos de modificar ligeramente esta expresión notando dos cosas</p>
<ol style="list-style-type: decimal">
<li><p><span class="math display">\[\begin{equation*}
\frac{1}{2} I \left( \left\vert u \right\vert \leq 1 \right)
\end{equation*}\]</span>
con <span class="math inline">\(u = \frac{x-xi}{h}\)</span></p></li>
<li></li>
</ol>
<p><span class="math display">\[\begin{equation*}
\frac{1}{2}\# \{ X_i \in [x-h,x+h) \}
=\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)
=\sum_{i=1}^{n}  \frac{1}{2} I \left( \left\vert \frac{x-x_{i}}{h}
\right\vert \leq 1 \right)
\end{equation*}\]</span>
\end{enumerate}</p>
<p>Finalmente se tiene que</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)
\end{equation*}\]</span></p>
<!-- \begin{center} -->
<!-- \includegraphics[width=\linewidth]{manual_figure/np-density-interval-crop.pdf} -->
<!-- \end{center} -->

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Qué pasaría si cambiaríamos la función <span class="math inline">\(K\)</span> del histograma por una más general?
</div>

<p>Esta función debería cumplir las siguientes características</p>
<ul>
<li><span class="math inline">\(K(u)\geq 0\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} K(u)du = 1\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} u K(u)du = 0\)</span>.</li>
<li><span class="math inline">\(\int_{-\infty}^{\infty} u^{2} K(u)du &lt;\infty\)</span>.</li>
</ul>
<p>Por ejemplo:</p>
<ul>
<li><strong>Uniforme:</strong> <span class="math inline">\(\frac{1}{2} I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Triangular:</strong> <span class="math inline">\((1-|u|) I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Epanechnikov:</strong> <span class="math inline">\(\frac{3}{4} (1-u^{2}) I \left( \left\vert u \right\vert \leq 1 \right)\)</span>.</li>
<li><strong>Gausian:</strong> <span class="math inline">\(\frac{1}{\sqrt{2\pi}} \exp \left( -\frac{1}{2}u^{2} \right)\)</span>.</li>
</ul>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-16-1.svg" width="672" /></p>
<p>Entonces se tendría que la expresión general para un estimador por núcleos es</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-x_{i}}{h} \right)
\end{equation*}\]</span></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Qué pasaría si modificamos el ancho de banda <span class="math inline">\(h\)</span> para un mismo kernel?
</div>

<p>Nuevamente sería el ancho de banda ya que</p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-18-1.svg" width="672" /></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Qué pasaría si modificamos el kernel para un mismo ancho de banda <span class="math inline">\(h\)</span>?
</div>

<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-20-1.svg" width="672" /></p>
<p>Recordemos nuevamente la fórmula</p>
<p><span class="math display">\[\begin{equation*}
\hat{f}_{h}\left( x \right) = \frac{1}{nh}\sum_{i=1}^{n} K\left( \frac{x-X_{i}}{h} \right)
\end{equation*}\]</span></p>
<p>Cada sumando de esta expresión es una función por si misma. Si la integramos se obtiene que</p>
<p><span class="math display">\[\begin{equation*}
\frac{1}{nh}\int K\left( \frac{x-X_{i}}{h} \right) dx
= \frac{1}{nh} \int K\left( u \right) h du
= \frac{1}{n} \int K(u) du
= \frac{1}{n}
\end{equation*}\]</span></p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-21-1.svg" width="672" /></p>
</div>
</div>
<div id="propiedades-estadísticas-1" class="section level2">
<h2><span class="header-section-number">2.3</span> Propiedades Estadísticas</h2>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> ¿Podríamos imitar lo mismo que hicimos para el histograma?
</div>

<p>Si. Las propiedades que vimos anteriormente son universales para estimadores.</p>
<p>Entonces:
<span class="math display">\[\begin{align*}
\mathrm{MSE}(\hat{f}_{h}(x)) &amp; =\mathrm{Var}(\hat{f}_{h}(x))+\mathrm{Sesgo}^{2} (\hat{f}_{h}(x))            \\
\mathrm{MISE}(\hat{f}_{h})   &amp; =\int\mathrm{Var}(\hat{f}_{h}(x))dx+\int\mathrm{Sesgo}^{2}(\hat{f}_{h}(x))dx
\end{align*}\]</span></p>
<p>donde</p>
<p><span class="math inline">\(\mathrm{Var}\left(\hat{f}_{h}(x)\right)=\mathbb{E}\left[\hat{f}_{h}(x)-\mathbb{E}\hat{f}_{h}(x)\right]^{2}\)</span> and <span class="math inline">\(\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)=\mathbb{E}\left[\hat{f}_{h}(x)\right]-f(x)\)</span>.</p>
<div id="varianza-1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Varianza</h3>
<p><span class="math display">\[\begin{align*}
\mathrm{Var}(\hat{f}_{h}(x))
&amp; =\mathrm{Var}\left(\frac{1}{n}\sum_{i=1}^{n}K\left(\frac{x-X_{i}}{h}\right)\right)          \\
&amp; =\frac{1}{n^{2}h^{2}}\sum_{i=1}^{n}\mathrm{Var}\left(K\left(\frac{x-X_{i}}{h}\right)\right) \\
&amp; =\frac{1}{nh^{2}}\mathrm{Var}\left(K\left(\frac{x-X}{h}\right)\right)                       \\
&amp; =\frac{1}{nh^{2}}\left\{
\textcolor{red}{\mathbb{E}\left[K^{2}\left(\frac{x-X}{h}\right)\right]}
-\left\{
\textcolor{blue}{\mathbb{E}\left[K\left(\frac{x-X}{h}\right)\right]}
\right\}^{2}
\right\}.
\end{align*}\]</span>
Usando que:
<span class="math display">\[\begin{align*}
\textcolor{red}{\mathbb{E}\left[K^{2}\left(\frac{x-X}{h}\right)\right]}
&amp; =\int K^{2}\left(\frac{x-s}{h}\right)f(s)ds            \\
&amp; =h\int K^{2}\left(u\right)f(uh+x)du                    \\
&amp; =h\int K^{2}\left(u\right)\left\{ f(x)+o(1)\right\} du \\
&amp; =h\left\{ \Vert K\Vert_{2}^{2}f(x)+o(1)\right\} .
\end{align*}\]</span></p>
<p><span class="math display">\[\begin{align*}
\textcolor{blue}{\mathbb{E}\left[K\left(\frac{x-X}{h}\right)\right]}
&amp; =\int K\left(\frac{x-s}{h}\right)f(s)ds            \\
&amp; = h\int K\left(u\right)f(uh+x)du                    \\
&amp; =h\int K\left(u\right)\left\{ f(x)+o(1)\right\} du \\
&amp; =h\left\{f(x)+o(1)\right\} .
\end{align*}\]</span></p>
<p>Por lo tanto se obtiene que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Var}\left(\hat{f}_{h}(x)\right) = \frac{1}{nh} \Vert K\Vert_{2}^{2}f(x) + o\left(\frac{1}{nh}\right), \text{ si } nh\to \infty.
\end{equation*}\]</span></p>
</div>
<div id="sesgo-1" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Sesgo</h3>
<p>Para el sesgo tenemos</p>
<p><span class="math display">\[\begin{align*}
\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)
&amp; = \mathbb{E}\left[\hat{f}_{h}(x)\right]-f(x)                                                  \\
&amp; = \frac{1}{nh} \sum_{i=1}^{n} \mathrm{E}\left[K\left( \frac{x-X_{i}}{h} \right)\right] - f(x) \\
&amp; = \frac{1}{h}\mathrm{E}\left[K\left( \frac{x-X_{1}}{h} \right)\right] - f(x)                  \\
&amp; = \int \frac{1}{h} K\left( \frac{x-u}{h}\right)f(u)du -f(x)                                   \\
\end{align*}\]</span></p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-23" class="exercise"><strong>Ejercicio 2.3  </strong></span>Usando el cambio de variable <span class="math inline">\(s=\frac{u-x}{h}\)</span> y las propiedades del kernel pruebe que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{Sesgo}\left(\hat{f}_{h}(x)\right) = \frac{h^{2}}{2} f^{\prime\prime} \mu_{2}(K) + o(h^{2}), \text{ si } h\to 0
\end{equation*}\]</span>
donde <span class="math inline">\(\mu_{2}=\int s^{2}K(s)ds\)</span>.</p>

</div>


<div class="solution">
 <span class="solution"><em>Solución. </em></span> <span class="math display">\[\begin{align*}
\mathrm{Sesgo}(\hat{f_{h}}(x)) &amp; = \int \frac{1}{h} K\left( \frac{x-u}{h} \right) f(u)du - f(x)     \\
&amp; = \frac{1}{h} \int hK(s)f(sh+x) ds - f(x) \\
&amp; = \int K(s)\Biggl[ f(x) + f^{\prime}(x)(sh+x-x)  \\
&amp;  \qquad  + \frac{f^{\prime\prime}(x)}{2}(sh+x-x)^2 + o(h^{2}) \Biggr] - f(x) \\
&amp; = \int K(s)f(x)ds + \int hf^{\prime}(x)sK(s) ds  \\
&amp; \qquad  + \int \frac{h^2}{2} f^{\prime\prime}(x)s^2K(s) ds + o(h^2) - f(x) \\
&amp; = f(x) + 0 + \frac{h^2}{2}f^{\prime\prime}(x)\mu_{2}(K) + o(h^2) - f(x)   \\
&amp; = \frac{h^2}{2}f^{\prime\prime}(x)\mu_{2}(K) + o(h^2) \\
\end{align*}\]</span>
</div>

<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-25-1.svg" width="672" /></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Note como los cambios en el ancho de banda modifican la suavidad (sesgo) y el aplanamiento de la curva (varianza).
</div>

</div>
<div id="error-cuadrático-medio-y-error-cuadrático-medio-integrado" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Error cuadrático medio y Error cuadrático medio integrado</h3>
<p>El error cuadrático medio se escribe
<span class="math display">\[\begin{align*}
\mathrm{MSE}(\hat{f}_{h}(x))
&amp; = \mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)^{2} + \mathrm{Var}\left(\hat{f}_{h}(x)\right)                                                 \\
&amp; = \frac{h^{4}}{4}\left(\mu_{2}(K)f^{\prime\prime}(x)\right)^{2}+\frac{1}{nh}\Vert K\Vert_{2}^{2}f(x)+o(h^{4})+o\left(\frac{1}{nh}\right).
\end{align*}\]</span></p>
<p>Y el error cuadrático medio integrado se escribe como,
<span class="math display">\[\begin{align*}
\mathrm{MISE}\left(\hat{f}_{h}\right) &amp; = \int \mathrm{MSE}\left(\hat{f}_{h}(x)\right)dx                                                                                                        \\
&amp; = \int \mathrm{Sesgo}\left(\hat{f}_{h}(x)\right)^{2} + \mathrm{Var}\left(\hat{f}_{h}(x)\right)dx                                                        \\
&amp; = \frac{h^{4}}{4}\mu_{2}^{2}(K)\left\Vert f^{\prime\prime}(x)\right\Vert_{2}^{2} +\frac{1}{nh}\Vert K\Vert_{2}^{2}+o(h^{4})+o\left(\frac{1}{nh}\right).
\end{align*}\]</span></p>
</div>
<div id="ancho-de-banda-óptimo" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Ancho de banda óptimo</h3>
<p>Minimizando el <span class="math inline">\(\mathrm{MISE}\)</span> con respecto a <span class="math inline">\(h\)</span> obtenemos
<span class="math display">\[\begin{equation*}
h_{opt}=\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right).
\end{equation*}\]</span></p>

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> De forma práctica, <span class="math inline">\(h_{opt}\)</span> no es un estimador útil de <span class="math inline">\(h\)</span> porque depende de <span class="math inline">\(\Vert f^{\prime\prime}\Vert_{2}^{2}\)</span> que es desconocido.</p>
Más adelante veremos otra forma de encontrar este estimador.
</div>

<p>Evaluando <span class="math inline">\(h_{opt}\)</span> en el <span class="math inline">\(\mathrm{MISE}\)</span> tenemos que</p>
<p><span class="math display">\[\begin{equation*}
\mathrm{MISE}(\hat{f}_{h})=\frac{5}{4}\left(\Vert K\Vert_{2}^{2}\right)^{4/5}\left(\Vert f^{\prime\prime}\Vert_{2}^{2}\mu_{2}(K)\right)^{2/5}n^{-4/5} = O\left( n^{-4/5} \right).
\end{equation*}\]</span></p>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-28-1.svg" width="672" /></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Formalmente, es posible probar que si <span class="math inline">\(f\)</span> es <span class="math inline">\(\beta\)</span> veces continuamente diferenciable y <span class="math inline">\(\int\left(f^{(\beta)}\right)^{2}&lt;\infty\)</span>, entonces se tiene que
<span class="math display">\[
{\displaystyle h_{opt}=O\left(n^{-\frac{1}{2\beta+1}}\right).}
\]</span>
Por lo tanto se podría aproximar a una tasa paramétrica de convergencia si
<span class="math inline">\(\beta\)</span> es grande.
</div>

</div>
</div>
<div id="escogiendo-el-ancho-de-banda" class="section level2">
<h2><span class="header-section-number">2.4</span> Escogiendo el ancho de banda</h2>

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> La principal característica del ancho de banda
<span class="math display">\[\begin{equation*}
h_{opt}=\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right).
\end{equation*}\]</span></p>
<p>ES QUE ¡NO FUNCIONA!</p>
</div>

<p>Veremos dos métodos para determinar un <span class="math inline">\(h\)</span> que funcione:</p>
<ul>
<li>Referencia normal.</li>
<li>Validación cruzada.</li>
</ul>
<div id="referencia-normal" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Referencia normal</h3>

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> Este método es más efectivo si se conoce que la verdadera distribución es bastante suave, unimodal y simétrica.</p>
Más adelante veremos otro método para densidades más generales.
</div>

<p>Asuma que <span class="math inline">\(f\)</span> es normal distribuida y se utiliza un kernel <span class="math inline">\(K\)</span> gausiano. Entonces se tiene que</p>
<p><span class="math display">\[\begin{align*}
\hat{h}_{rn} &amp; =\left(\frac{\Vert K\Vert_{2}^{2}}{\Vert f^{\prime\prime}\Vert_{2}^{2}\left(\mu_{2}(K)\right)^{2}n}\right)^{1/5}=O\left( n^{-1/5} \right) \\
&amp; =1.06 \hat{\sigma} n^{-1/5}.
\end{align*}\]</span></p>
<p>donde</p>
<p><span class="math display">\[\begin{equation*}
\hat{\sigma} = \sqrt{\frac{1}{n-1} \sum_{i=1}^{n} \left( x_{i}-\bar{x}^{2} \right)}
\end{equation*}\]</span></p>

<div class="exercise">
<span id="exr:unnamed-chunk-32" class="exercise"><strong>Ejercicio 2.4  </strong></span>Pruebe que la ecuación anterior es verdadera. Es decir, calcule <span class="math inline">\(\Vert K\Vert_{2}^{2}\)</span>, <span class="math inline">\(\Vert f^{\prime\prime}\Vert_{2}^{2}\)</span> y <span class="math inline">\(\mu_{2}(K)\)</span>
</div>


<div class="remark">
 <span class="remark"><em>Nota: </em></span> Un problema con <span class="math inline">\(\hat{h}_{rn}=1.06 \hat{\sigma} n^{-1/5}\)</span> es su sensibilidad a los valores extremos.
</div>


<div class="example">
<p><span id="exm:unnamed-chunk-34" class="example"><strong>Ejemplo 2.1  </strong></span>La varianza empírica de 1, 2, 3, 4, 5, es 2.5.</p>
La varianza empírica de 1, 2, 3, 4, 5, 99, es 1538.
</div>

<p>El rango intercuantil IQR se define como
<span class="math display">\[\begin{equation*}
\mathrm{IQR}^{X} = Q^{X}_{3} - Q^{X}_{1}
\end{equation*}\]</span>
donde <span class="math inline">\(Q^{X}_{1}\)</span> y <span class="math inline">\(Q^{X}_{3}\)</span> son el primer y tercer de un conjunto de datos <span class="math inline">\(X_{1},\ldots, X_n\)</span>.</p>
<p>Con el supuesto que <span class="math inline">\(X\sim \mathcal{N}(\mu,\sigma^{2})\)</span> entonces <span class="math inline">\(\displaystyle Z = \frac{X-\mu}{\sigma} \sim \mathcal{N}(0,1)\)</span>.</p>
<p>Entonces,
<span class="math display">\[\begin{align*}
\mathrm{IQR}
&amp; = Q^{X}_{3} - Q^{X}_{1}                                                     \\
&amp; = \left( \mu+\sigma Q^{Z}_{3} \right) - \left( \mu+\sigma Q^{Z}_{1} \right) \\
&amp; = \sigma \left(Q^{Z}_{3} - Q^{Z}_{1} \right)                                \\
&amp; \approx \sigma \left( 0.67 - (0.67) \right)                                 \\
&amp; =1.34 \sigma.
\end{align*}\]</span></p>
<p>Por lo tanto <span class="math inline">\(\displaystyle \hat{\sigma} = \frac{\widehat{\mathrm{IQR}}^{X}}{1.34}\)</span></p>
<p>Podemos sustituir la varianza empírica de la fórmula inicial y tenemos
<span class="math display">\[\begin{equation*}
\hat{h}_{rn} = 1.06 \frac{\widehat{\mathrm{IQR}}^{X}}{1.34} n^{-\frac{1}{5}} \approx 0.79\  \widehat{\mathrm{IQR}}^{X}\ n^{-\frac{1}{5}}
\end{equation*}\]</span></p>
<p>Combinando ambos estimadores, podemos obtener,</p>
<p><span class="math display">\[\begin{equation*}
\hat{h}_{rn} = 1.06 \min \left\{\frac{\widehat{\mathrm{IQR}}^{X}}{1.34}, \hat{\sigma }\right\} n^{-\frac{1}{5}}
\end{equation*}\]</span></p>
</div>
<div id="validación-cruzada" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Validación Cruzada</h3>
<p>Defina el <em>error cuadrático integrado</em> como
<span class="math display">\[\begin{align*}
\mathrm{ISE}(\hat{f}_{h}) &amp; =\int\left(\hat{f}_{h}(x)-f(x)\right)^{2}dx\nonumber                   \\
&amp; =\int \hat{f}_{h}^{2}(x)dx-2\int \hat{f}_{h}(x)f(x)dx+\int f^{2}(x)dx.
\end{align*}\]</span></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> El MISE es el valor esperado del ISE.
</div>

<p>Nuestro objetivo es minimizar el ISE con respecto a <span class="math inline">\(h\)</span>.</p>
<p>Primero note que <span class="math inline">\(\int f^{2}(x)dx\)</span> NO DEPENDE de <span class="math inline">\(h\)</span>. Podemos minimizar la expresión
<span class="math display">\[\begin{equation*}
\mathrm{ISE}(\hat{f}_{h})-\int f^{2}(x)dx=
\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}
-2
\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}
\end{equation*}\]</span></p>
<p>Vamos a resolver esto en dos pasos partes</p>
<p><strong>Integral <span class="math inline">\(\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}\)</span></strong></p>
<p>El término <span class="math inline">\(\textcolor{blue}{\int\hat{f}_{h}(x)f(x)dx}\)</span> es el valor esperado de
<span class="math inline">\(\mathrm{E}\left[\hat{f}(X)\right]\)</span>. Su estimador es
<span class="math display">\[\begin{equation*}
\widehat{\mathrm{E}\left[\hat{f}(X)\right]}
= \frac{1}{n}\sum_{i=1}^{n}\hat{f}_{h}(X_{i})
=\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{j=1}^{n}
K\left(\frac{X_{j}-X_{i}}{h}\right).
\end{equation*}\]</span></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> El problema con esta expresión es que las observaciones que se usan para estimar la esperanza son las misma que se usan para estimar <span class="math inline">\(\hat{f}_{h}(x)\)</span> (Se utilizan doble).
</div>

<p>La solución es remover la <span class="math inline">\(i^{\text{ésima}}\)</span> observación de <span class="math inline">\(\hat{f}_{h}\)</span> para cada <span class="math inline">\(i\)</span>.</p>
<p>Redefiniendo el estimador anterior tenemos <span class="math inline">\(\int \hat{f}_{h}(x)f(x)dx\)</span> como
<span class="math display">\[
\frac{1}{n}\sum_{i=1}^{n}\hat{f}_{h,-i}(X_{i}),
\]</span>
donde
<span class="math display">\[
\hat{f}_{h,-i}(x)=\frac{1}{(n-1)h}\sum_{\substack{j=1\\ j\neq i}}^{n}K\left( \frac{x-X_{i}}{h} \right) .
\]</span></p>
<p><strong>Integral <span class="math inline">\(\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}\)</span></strong></p>
<p>Siguiendo con el término <span class="math inline">\(\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}\)</span> note que este se puede reescribir como</p>
<p><span class="math display">\[\begin{align*}
\textcolor{red}{\int\hat{f}_{h}^{2}(x)dx}
&amp; =\int\left(\frac{1}{nh}\sum_{i=1}^{n}K\left( \frac{x-X_{i}}{h} \right)\right)^{2}dx                                    \\
&amp; =\frac{1}{n^{2}h^{2}}\sum_{i=1}^{n}\sum_{i=1}^{n}\int K\left(\frac{x-X_{i}}{h}\right)K\left(\frac{x-X_{j}}{h}\right)dx \\
&amp; =\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{i=1}^{n}\int K\left(u\right)K\left(\frac{X_{i}-X_{j}}{h}-u\right)du               \\
&amp; =\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{i=1}^{n}K*K\left(\frac{X_{i}-X_{j}}{h}\right).
\end{align*}\]</span></p>
<p>donde <span class="math inline">\(K*K\)</span> es la convolución de <span class="math inline">\(K\)</span> consigo misma.</p>
<p>Finalmente tenemos la función,</p>
<p><span class="math display">\[
\mathrm{CV}(h)=\frac{1}{n^{2}h}\sum_{i=1}^{n}\sum_{j=1}^{n}K*K\left(\frac{X_{i}-X_{j}}{h}\right)-\frac{2}{(n-1)h}\sum_{i=1}^{n}\mathop{\sum_{j=1}^{n}}_{j\neq i}K\left( \frac{X_{i}-X_{j}}{h} \right).
\]</span></p>

<div class="remark">
 <span class="remark"><em>Nota: </em></span> Note que <span class="math inline">\(\mathrm{CV}(h)\)</span> no depende de <span class="math inline">\(f\)</span> o sus derivadas.
</div>


<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> Para efectos prácticos es mejor utilizar el criterio</p>
<span class="math display">\[
CV(h)=\int\hat{f}_{h}^{2}(x)dx-\frac{2}{(n-1)h}\sum_{i=1}^{n}\mathop{\sum_{j=1}^{n}}_{j\neq i}K\left( \frac{X_{i}-X_{j}}{h} \right)
\]</span>
y luego calcular numéricamente la integral.
</div>

</div>
<div id="intervalos-de-confianza-para-estimadores-de-densidad-no-paramétricos" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Intervalos de confianza para estimadores de densidad no paramétricos</h3>
<p>Usando los resultados anteriores y asumiendo que <span class="math inline">\(h=cn^{-\frac{1}{5}}\)</span> entonces</p>
<p><span class="math display">\[\begin{equation*}
n^{-\frac{2}{5}} \left\{ \hat{f}_{h}(x) -f(x)\right\}
\xrightarrow{\mathcal{L}} \mathcal{N}\left(\underbrace{\frac{c^{2}}{2} f^{\prime\prime}
\mu_{2}(K)}_{b_{x}}, \underbrace{\frac{1}{c}f(x) \left\Vert K \right\Vert_{2}^{2}}_{v_{x}}\right).
\end{equation*}\]</span></p>
<p>Si <span class="math inline">\(z_{1-\frac{\alpha}{2}}\)</span> es el cuantil <span class="math inline">\(1-\frac{\alpha}{2}\)</span> de una distribución normal estándar, entonces</p>
<p><span class="math display">\[\begin{align*}
1-\alpha
&amp; \approx \mathbb{P}\left(b_{x}-z_{1-\frac{\alpha}{2}} v_{x} \leq n^{2 / 5}\left\{\widehat{f}_{h}(x)-f(x)\right\} \leq b_{x}+z_{1-\frac{\alpha}{2}} v_{x}\right) \\
&amp; =\mathbb{P}\left(\widehat{f}_{h}(x)-n^{-2 / 5}\left\{b_{x}+z_{1-\frac{\alpha}{2}} v_{x}\right\}\right.                                                         \\
&amp; \qquad\qquad \left. \leq f(x)\leq \hat{f}_{h}(x)-n^{-2 / 5}\left\{b_{x}-z_{1-\frac{\alpha}{2}} v_{x}\right\}\right)
\end{align*}\]</span></p>
<p>Esta expresión nos dice que con una probabilidad de <span class="math inline">\(1-\alpha\)</span> se tiene que</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
&amp; \left[\hat{f}_{h}(x)-\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)-z_{1-\frac{\alpha}{2}} \sqrt{\frac{f(x)\|K\|_{2}^{2}}{n h}}\right. \\
&amp; \left.\widehat{f}_{h}(x)-\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)+z_{1-\frac{a}{2}} \sqrt{\frac{f(x)\|K\|_{2}^{2}}{n h}}\right]
\end{aligned}
\end{equation*}\]</span></p>
<p>Al igual que en los casos anteriores, este invtervalo no es útil ya que depende de <span class="math inline">\(f(x)\)</span> y <span class="math inline">\(f^{\prime\prime} (x)\)</span>.</p>
<p>Si <span class="math inline">\(h\)</span> es pequeño relativamente a <span class="math inline">\(n^{-\frac{1}{5}}\)</span> entonces el segundo término <span class="math inline">\(\frac{h^{2}}{2} f^{\prime \prime}(x) \mu_{2}(K)\)</span> podría ser ignorado.</p>
<p>Podemos reemplazar <span class="math inline">\(f(x)\)</span> por su estimador <span class="math inline">\(\hat{f}_{h}(x)\)</span>. Entonces tendríamos una intervalo aplicable a nuestro caso</p>
<p><span class="math display">\[\begin{equation*}
\left[\hat{f_{h}}(x)-z_{1-\frac{\alpha}{2}} \sqrt{\frac{\hat{f_{h}}(x)\|K\|_{2}^{2}}{n h}}, \hat{f}_{h}(x)+z_{1-\frac{\alpha}{2}} \sqrt{\frac{\hat{f}_{h}(x)\|\mathrm{K}\|_{2}^{2}}{n h}}\right]
\end{equation*}\]</span></p>

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> Este intervalo de confianza solo funciona en cada punto particular de <span class="math inline">\(f(x)\)</span>.</p>
Existe una versión más general para determinar la banda de confianza de toda la función. Por favor revisar la página 62 de <span class="citation">(Härdle et al. <a href="#ref-Hardle2004">2004</a>)</span>.
</div>

</div>
</div>
<div id="laboratorio" class="section level2">
<h2><span class="header-section-number">2.5</span> Laboratorio</h2>
<p>Comenzaremos con una librería bastante básica llamada .</p>
<div id="efecto-de-distintos-kernels-en-la-estimación" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Efecto de distintos Kernels en la estimación</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">x &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/stockres.txt&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">x &lt;-<span class="st"> </span><span class="kw">unlist</span>(x)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">summary</span>(x)</a></code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -0.6118200 -0.0204085 -0.0010632 -0.0004988  0.0215999  0.1432286</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(KernSmooth)</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3">fhat_normal &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">plot</span>(fhat_normal, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-42-1.svg" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">fhat_unif &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">plot</span>(fhat_unif, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-42-2.svg" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">fhat_epanech &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epanech&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">plot</span>(fhat_epanech, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-42-3.svg" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">fhat_biweight &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;biweight&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">plot</span>(fhat_biweight, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-42-4.svg" width="672" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">fhat_triweight &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;triweight&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">plot</span>(fhat_triweight, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-42-5.svg" width="672" /></p>
</div>
<div id="efecto-del-ancho-de-banda-en-la-estimación" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Efecto del ancho de banda en la estimación</h3>
<p>** Kernel uniforme **</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fhat &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">plot</span>(fhat, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-43-1.svg" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">fhat &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;box&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">plot</span>(fhat, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-43-2.svg" width="672" /></p>
<p>** Kernel Epanechnikov **</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">fhat &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">plot</span>(fhat, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-44-1.svg" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">fhat &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">plot</span>(fhat, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-44-2.svg" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">suppressMessages</span>(<span class="kw">library</span>(tidyverse))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">library</span>(gganimate)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4">fani &lt;-<span class="st"> </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="cf">for</span> (b <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.02</span>, <span class="dt">length.out =</span> <span class="dv">40</span>)) {</a>
<a class="sourceLine" id="cb13-7" title="7">    f &lt;-<span class="st"> </span><span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> b, <span class="dt">gridsize =</span> <span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb13-8" title="8">    fani &lt;-<span class="st"> </span>fani <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">xreal =</span> <span class="kw">sort</span>(x), </a>
<a class="sourceLine" id="cb13-9" title="9">        <span class="dt">x =</span> f<span class="op">$</span>x, <span class="dt">y =</span> f<span class="op">$</span>y, <span class="dt">bw =</span> b))</a>
<a class="sourceLine" id="cb13-10" title="10">}</a>
<a class="sourceLine" id="cb13-11" title="11"></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="kw">ggplot</span>(<span class="dt">data =</span> fani) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Ancho de banda = {closest_state}&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-14" title="14"><span class="st">    </span><span class="kw">transition_states</span>(bw) <span class="op">+</span><span class="st"> </span><span class="kw">view_follow</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## Error in device(files[i], ...): unused arguments (units = &quot;in&quot;, res = 192)</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># anim_save(&#39;manual_figure/bandwidth-animation.gif&#39;)</span></a></code></pre></div>
<!-- \includemedia[ -->
<!-- label=bandwidth, -->
<!-- width=0.6\linewidth,height=0.45\linewidth, -->
<!-- addresource=manual_figure/bandwidth-animation.mp4, -->
<!-- transparent, -->
<!-- %transparent player background -->
<!-- activate=pageopen, -->
<!-- %show VPlayer's right-click menu -->
<!-- flashvars={ -->
<!-- source=manual_figure/bandwidth-animation.mp4 -->
<!-- &loop=true -->
<!-- % loop video -->
<!-- } -->
<!-- ]{}{VPlayer.swf} -->

<div class="remark">
<p> <span class="remark"><em>Nota: </em></span> 
- Construya una variable llamada <code>u</code> que sea una secuencia de -0.15 a 0.15 con un paso de 0.01
- Asigne <code>x</code> a los datos <code>stockrel</code> y calcule su media y varianza.
- Usando la función <code>dnorm</code> construya los valores de la distribución de los datos usando la media y varianza calculada anteriormente. Asigne a esta variable <code>f\_param</code>.
- Defina un ancho de banda <code>h</code> en 0.02
- Construya un histograma para estos datos con ancho de banda <code>h</code>. Llame a esta variable <code>f\_hist</code>
- Usando el paquete <code>KernSmooth</code> y la función <code>bkde</code>, construya una función que calcule el estimador no paramétrico con un núcleo Epanechivok para un ancho de banda <span class="math inline">\(h\)</span>. Llame a esta variable <code>f\_epa</code>.
- Dibuje en el mismo gráfico la estimación paramétrica y no paramétrica.</p>
</div>

<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">x &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/stockres.txt&quot;</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">x &lt;-<span class="st"> </span><span class="kw">unlist</span>(x)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co"># Eliminar nombres de las columnas</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6">u &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8">mu &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb16-9" title="9">sigma &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11">f_param &lt;-<span class="st"> </span><span class="kw">dnorm</span>(u, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)</a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13">h &lt;-<span class="st"> </span><span class="fl">0.02</span></a>
<a class="sourceLine" id="cb16-14" title="14"></a>
<a class="sourceLine" id="cb16-15" title="15">n_bins &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">diff</span>(<span class="kw">range</span>(x))<span class="op">/</span>h)</a>
<a class="sourceLine" id="cb16-16" title="16"></a>
<a class="sourceLine" id="cb16-17" title="17">f_hist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> n_bins)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-47-1.svg" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">f_epa &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> h))</a>
<a class="sourceLine" id="cb17-2" title="2"></a>
<a class="sourceLine" id="cb17-3" title="3">x_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x)</a>
<a class="sourceLine" id="cb17-4" title="4"></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb17-6" title="6"></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb17-8" title="8">    <span class="dt">binwidth =</span> <span class="fl">0.02</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb17-10" title="10">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> f_epa, </a>
<a class="sourceLine" id="cb17-11" title="11">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-47-2.svg" width="672" /></p>
</div>
<div id="ancho-de-banda-óptimo-1" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Ancho de banda óptimo</h3>
<p>Usemos la regla de la normal o también conocida como Silverman.
<strong>Primero recuerde que en este caso se asume que <span class="math inline">\(f(x)\)</span> sigue una distribución normal</strong>. En este caso, lo que se obtiene es que</p>
<p><span class="math display">\[\begin{align*}
\Vert f^{\prime \prime} \Vert_2^2 &amp; = \sigma ^{-5} \int \{\phi^{\prime \prime}\}^2 dx              \\
&amp; = \sigma ^{-5} \frac{3}{8\sqrt{\pi}} \approx 0.212 \sigma^{-5}
\end{align*}\]</span></p>
<p>donde <span class="math inline">\(\phi\)</span> es la densidad de una normal estándar.</p>
<p>El estimador para <span class="math inline">\(\sigma\)</span> es</p>
<p><span class="math display">\[
s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2  }.
\]</span></p>
<p>Y usando el cálculo realizado anteriormente, se obtiene que</p>
<p><span class="math display">\[
h_{normal} = \left( \frac{4 s^5}{3n} \right)^{1/5} \approx 1.06 s n^{-1/5}.
\]</span></p>
<p>Un estimador más robusto es</p>
<p><span class="math display">\[
h_{normal} =  1.06 \min \left\{ s , \frac{IQR}{1.34} \right\} n^{-1/5}.
\]</span></p>
<p>¿Por qué es <span class="math inline">\(IQR / 1.34\)</span>?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">s &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb18-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">h_normal &lt;-<span class="st"> </span><span class="fl">1.06</span> <span class="op">*</span><span class="st"> </span>s <span class="op">*</span><span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3">h &lt;-<span class="st"> </span>h_normal</a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5">n_bins &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">diff</span>(<span class="kw">range</span>(x))<span class="op">/</span>h)</a>
<a class="sourceLine" id="cb19-6" title="6">f_hist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> n_bins, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb19-7" title="7">f_epa &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> h))</a>
<a class="sourceLine" id="cb19-8" title="8"></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb19-10" title="10">    <span class="dt">binwidth =</span> h, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb19-12" title="12">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> f_epa, </a>
<a class="sourceLine" id="cb19-13" title="13">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-49-1.svg" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">h_iqr &lt;-<span class="st"> </span><span class="fl">1.06</span> <span class="op">*</span><span class="st"> </span><span class="kw">min</span>(s, <span class="kw">IQR</span>(x)<span class="op">/</span><span class="fl">1.34</span>) <span class="op">*</span><span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3">h &lt;-<span class="st"> </span>h_iqr</a>
<a class="sourceLine" id="cb20-4" title="4"></a>
<a class="sourceLine" id="cb20-5" title="5">n_bins &lt;-<span class="st"> </span><span class="kw">floor</span>(<span class="kw">diff</span>(<span class="kw">range</span>(x))<span class="op">/</span>h)</a>
<a class="sourceLine" id="cb20-6" title="6">f_hist &lt;-<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks =</span> n_bins, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb20-7" title="7">f_epa &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">bkde</span>(x, <span class="dt">kernel =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">bandwidth =</span> h))</a>
<a class="sourceLine" id="cb20-8" title="8"></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb20-10" title="10">    <span class="dt">binwidth =</span> h, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb20-12" title="12">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> f_epa, </a>
<a class="sourceLine" id="cb20-13" title="13">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-50-1.svg" width="672" /></p>
<p>Una librería más especializada es  (non-parametric).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">library</span>(np)</a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3">x.eval &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb21-4" title="4"></a>
<a class="sourceLine" id="cb21-5" title="5">h_normal_np &lt;-<span class="st"> </span><span class="kw">npudensbw</span>(<span class="dt">dat =</span> x, <span class="dt">bwmethod =</span> <span class="st">&quot;normal-reference&quot;</span>)</a>
<a class="sourceLine" id="cb21-6" title="6"></a>
<a class="sourceLine" id="cb21-7" title="7">dens.ksum &lt;-<span class="st"> </span><span class="kw">npksum</span>(<span class="dt">txdat =</span> x, <span class="dt">exdat =</span> x.eval, <span class="dt">bws =</span> h_normal_np<span class="op">$</span>bw)<span class="op">$</span>ksum<span class="op">/</span>(n <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">    </span>h_normal_np<span class="op">$</span>bw[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10">dens.ksum.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x.eval, <span class="dt">y =</span> dens.ksum)</a>
<a class="sourceLine" id="cb21-11" title="11"></a>
<a class="sourceLine" id="cb21-12" title="12"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb21-13" title="13">    <span class="dt">binwidth =</span> h_normal_np<span class="op">$</span>bw, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-14" title="14"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb21-15" title="15">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dens.ksum.df, </a>
<a class="sourceLine" id="cb21-16" title="16">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-51-1.svg" width="672" /></p>
</div>
<div id="validación-cruzada-1" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Validación cruzada</h3>
<p>La forma que vimos en clase es la de validación cruzada por mínimos
cuadrados``least-square cross validation’’ la cual se puede ejecutar
con este comando.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">h_cv_np_ls &lt;-<span class="st"> </span><span class="kw">npudensbw</span>(<span class="dt">dat =</span> x, <span class="dt">bwmethod =</span> <span class="st">&quot;cv.ls&quot;</span>, </a>
<a class="sourceLine" id="cb22-2" title="2">    <span class="dt">ckertype =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">ckerorder =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">dens.np &lt;-<span class="st"> </span><span class="kw">npudens</span>(h_cv_np_ls)</a>
<a class="sourceLine" id="cb24-2" title="2"></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="kw">plot</span>(dens.np, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-52-1.svg" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">dens.np.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> dens.np<span class="op">$</span>eval[, <span class="dv">1</span>], <span class="dt">y =</span> dens.np<span class="op">$</span>dens)</a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb25-4" title="4">    <span class="dt">binwidth =</span> h_cv_np_ls<span class="op">$</span>bw, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb25-6" title="6">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dens.np.df, </a>
<a class="sourceLine" id="cb25-7" title="7">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-53-1.svg" width="672" /></p>
</div>
<div id="temas-adicionales" class="section level3">
<h3><span class="header-section-number">2.5.5</span> Temas adicionales</h3>
<p>** Reducción del sesgo **
Como lo mencionamos en el texto, una forma de mejorar el sesgo en la estimación es suponer que la función de densidad es más veces diferenciable.</p>
<p>Esto se logra asumiendo que el Kernel es más veces diferenciable.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">h_cv_np_ls &lt;-<span class="st"> </span><span class="kw">npudensbw</span>(<span class="dt">dat =</span> x, <span class="dt">bwmethod =</span> <span class="st">&quot;cv.ls&quot;</span>, </a>
<a class="sourceLine" id="cb26-2" title="2">    <span class="dt">ckertype =</span> <span class="st">&quot;epa&quot;</span>, <span class="dt">ckerorder =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">dens.np &lt;-<span class="st"> </span><span class="kw">npudens</span>(h_cv_np_ls)</a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">plot</span>(dens.np, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-54-1.svg" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">dens.np.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> dens.np<span class="op">$</span>eval[, <span class="dv">1</span>], <span class="dt">y =</span> dens.np<span class="op">$</span>dens)</a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb29-4" title="4">    <span class="dt">binwidth =</span> h_cv_np_ls<span class="op">$</span>bw, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb29-6" title="6">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dens.np.df, </a>
<a class="sourceLine" id="cb29-7" title="7">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-55-1.svg" width="672" /></p>
<p><strong>Otra forma de estimar el ancho de banda</strong> Otra forma de estimar ancho de bandas óptimos es usando máxima verosimilitud. Les dejo de tarea revisar la sección 1.1 del artículo de <span class="citation">(Hall <a href="#ref-Hall1987">1987</a>)</span> para entender su estructura.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">h_cv_np_ml &lt;-<span class="st"> </span><span class="kw">npudensbw</span>(<span class="dt">dat =</span> x, <span class="dt">bwmethod =</span> <span class="st">&quot;cv.ml&quot;</span>, </a>
<a class="sourceLine" id="cb30-2" title="2">    <span class="dt">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>)</a></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">dens.np &lt;-<span class="st"> </span><span class="kw">npudens</span>(h_cv_np_ml)</a>
<a class="sourceLine" id="cb32-2" title="2"></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="kw">plot</span>(dens.np, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-56-1.svg" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">dens.np.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> dens.np<span class="op">$</span>eval[, <span class="dv">1</span>], <span class="dt">y =</span> dens.np<span class="op">$</span>dens)</a>
<a class="sourceLine" id="cb33-2" title="2"></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb33-4" title="4">    <span class="dt">binwidth =</span> h_cv_np_ml<span class="op">$</span>bw, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb33-6" title="6">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dens.np.df, </a>
<a class="sourceLine" id="cb33-7" title="7">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-57-1.svg" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">h_cv_np_ml &lt;-<span class="st"> </span><span class="kw">npudensbw</span>(<span class="dt">dat =</span> x, <span class="dt">bwmethod =</span> <span class="st">&quot;cv.ml&quot;</span>, </a>
<a class="sourceLine" id="cb34-2" title="2">    <span class="dt">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>, <span class="dt">ckerorder =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## 
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 |
Multistart 1 of 1 /
Multistart 1 of 1 |
Multistart 1 of 1 |
                   </code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">dens.np &lt;-<span class="st"> </span><span class="kw">npudens</span>(h_cv_np_ml)</a>
<a class="sourceLine" id="cb36-2" title="2"></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw">plot</span>(dens.np, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-58-1.svg" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">dens.np.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> dens.np<span class="op">$</span>eval[, <span class="dv">1</span>], <span class="dt">y =</span> dens.np<span class="op">$</span>dens)</a>
<a class="sourceLine" id="cb37-2" title="2"></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="kw">ggplot</span>(x_df, <span class="kw">aes</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..), </a>
<a class="sourceLine" id="cb37-4" title="4">    <span class="dt">binwidth =</span> h_cv_np_ml<span class="op">$</span>bw, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="st">    </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mu, </a>
<a class="sourceLine" id="cb37-6" title="6">        <span class="dt">sd =</span> sigma), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dens.np.df, </a>
<a class="sourceLine" id="cb37-7" title="7">    <span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="Notas-Curso-Estadistica_files/figure-html/unnamed-chunk-59-1.svg" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">fani &lt;-<span class="st"> </span><span class="kw">tibble</span>()</a>
<a class="sourceLine" id="cb38-2" title="2"></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="cf">for</span> (b <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.001</span>, <span class="fl">0.05</span>, <span class="dt">length.out =</span> <span class="dv">40</span>)) {</a>
<a class="sourceLine" id="cb38-4" title="4">    f &lt;-<span class="st"> </span><span class="kw">npudens</span>(<span class="dt">tdat =</span> x, <span class="dt">ckertype =</span> <span class="st">&quot;epanechnikov&quot;</span>, </a>
<a class="sourceLine" id="cb38-5" title="5">        <span class="dt">bandwidth.compute =</span> <span class="ot">FALSE</span>, <span class="dt">bws =</span> b)</a>
<a class="sourceLine" id="cb38-6" title="6">    fani &lt;-<span class="st"> </span>fani <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(<span class="kw">tibble</span>(<span class="dt">xreal =</span> <span class="kw">sort</span>(x), </a>
<a class="sourceLine" id="cb38-7" title="7">        <span class="dt">x =</span> f<span class="op">$</span>eval<span class="op">$</span>x, <span class="dt">y =</span> f<span class="op">$</span>dens, <span class="dt">bw =</span> b))</a>
<a class="sourceLine" id="cb38-8" title="8">}</a>
<a class="sourceLine" id="cb38-9" title="9"></a>
<a class="sourceLine" id="cb38-10" title="10"><span class="kw">ggplot</span>(<span class="dt">data =</span> fani) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(x, y), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">paste0</span>(<span class="st">&quot;Ancho de banda = {closest_state}&quot;</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-12" title="12"><span class="st">    </span><span class="kw">theme_minimal</span>(<span class="dt">base_size =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span><span class="kw">transition_states</span>(bw) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-13" title="13"><span class="st">    </span><span class="kw">view_follow</span>()</a></code></pre></div>
<pre><code>## Error in device(files[i], ...): unused arguments (units = &quot;in&quot;, res = 192)</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># anim_save(&#39;manual_figure/bandwidth-animation-np.gif&#39;)</span></a></code></pre></div>
<!-- \includemedia[ -->
<!-- label=bandwidth, -->
<!-- width=0.6\linewidth,height=0.45\linewidth, -->
<!-- addresource=manual_figure/bandwidth-animation-np.mp4, -->
<!-- transparent, -->
<!-- %transparent player background -->
<!-- activate=pageopen, -->
<!-- %show VPlayer's right-click menu -->
<!-- flashvars={ -->
<!-- source=manual_figure/bandwidth-animation-np.mp4 -->
<!-- &loop=true -->
<!-- % loop video -->
<!-- } -->
<!-- ]{}{VPlayer.swf} -->

<div class="exercise">
<p><span id="exr:unnamed-chunk-61" class="exercise"><strong>Ejercicio 2.5  </strong></span>Implementar el intervalo confianza visto en clase para estimadores de densidades por núcleos y visualizarlo de en ggplot.</p>
<strong>Si se atreven: ¿Se podría hacer una versión animada de ese gráfico para visualizar el significado real de este el intervalo de confianza?</strong>
</div>

</div>
</div>
<div id="ejercicios" class="section level2">
<h2><span class="header-section-number">2.6</span> Ejercicios</h2>
<p>Del libro de <span class="citation">(Härdle et al. <a href="#ref-Hardle2004">2004</a>)</span> hagan los siguientes ejercicios</p>
<ol style="list-style-type: decimal">
<li><strong>Sección 2:</strong> 1, 2, 3, 5, 7, 14</li>
<li><strong>Sección 3:</strong> 4, 8, 10, 11, 16,</li>
</ol>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Hall1987">
<p>Hall, Peter. 1987. “On Kullback-Leibler Loss and Density Estimation.” <em>The Annals of Statistics</em> 15 (4): 1491–1519. <a href="https://doi.org/10.1214/aos/1176350606">https://doi.org/10.1214/aos/1176350606</a>.</p>
</div>
<div id="ref-Hardle2004">
<p>Härdle, Wolfgang, Axel Werwatz, Marlene Müller, and Stefan Sperlich. 2004. <em>Nonparametric and Semiparametric Models</em>. Springer Series in Statistics. Berlin, Heidelberg: Springer Berlin Heidelberg. <a href="https://doi.org/10.1007/978-3-642-17146-8">https://doi.org/10.1007/978-3-642-17146-8</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="jacknife-y-bootstrap.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/edit/master/01-estimacion-densidades-no-parametricas.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/maikol-solis/notas-curso-estadistica/blob/master/01-estimacion-densidades-no-parametricas.Rmd",
"text": null
},
"download": ["Notas-Curso-Estadistica.pdf"],
"toc": {
"collapse": "subsection"
},
"toc_depth": 4
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
